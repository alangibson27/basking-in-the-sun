<div>
    <form id="contactform">

        <div class="form-group">
            <label for="inputName">お名前</label>
            <input name="name" type="name" id="inputName" placeholder="お名前"><span class="feedback" id="nameFeedback">
        </div>

        <div class="form-group">
            <label for="inputEmail">メールアドレス</label>
            <input name="email" type="email" id="inputEmail" placeholder="メールアドレス"><span class="feedback" id="emailFeedback">
        </div>

        <div class="form-group">
            <label for="message">メッセージ</label>
            <textarea name="message" cols="80" rows="10" id="message"></textarea>
        </div>

        <input type="hidden" name="return" value="{{ .Permalink }}"/>
        <button type="submit" id="submit">送信</button><span class="feedback" id="response">

    </form>
</div>

<script>
    $(document).ready(function() {
        $("#submit").click(function(event) {
            event.preventDefault();

            var nameOk = validate("#inputName", "Please enter your name", "#nameFeedback", containsText);
            var emailOk = validate("#inputEmail", "Please enter your email address", "#emailFeedback", looksLikeEmailAddress);
            var messageOk = validate("#message", "Please enter a message", "#response", containsText);

            if (!nameOk || !emailOk || !messageOk) {
                return;
            }

            $("#submit").attr("disabled", true);
            $.ajax({
                type: "POST",
                url: "{{ .Site.Params.contactformaction }}",
                data: $("#contactform").serialize(),
                success: function() {
                    $("#response").text("Thank-you. Your message has been received.");
                    $("#submit").removeAttr("disabled");
                },
                error: function() {
                    $("#response").text("Your message could not be sent. Please try again later.");
                    $("#submit").removeAttr("disabled");
                }
            });
        });
    });

    function validate(fieldId, message, target, validator) {
        if (!validator($(fieldId).val())) {
            $(target).text(message);
            $(fieldId).focus();
            return false;
        } else {
            $(target).text("");
            return true;
        }
    }

    function containsText(str) {
        return str.trim().length > 0;
    }

    function looksLikeEmailAddress(str) {
        return str.split("@").length == 2;
    }
</script>